# Windows Configuration

Configuration steps, scripts and tools i use on windows machines. Feel free to skip any steps that don't work for you or add steps if you think something is missing.

### Setting up your development environment

1. Install [Chrome](https://www.google.com/chrome/)
2. Install [Dropbox](https://www.dropbox.com/downloading)
3. Install [Visual Studio](https://visualstudio.microsoft.com/downloads/)
4. Install [Visual Studio Code](https://code.visualstudio.com/Download) 
  
  - Check "Register Code as an editor for supported file types"
  
    *If you don't, everything will open in Visual Studio*
  
5. Install [Windows Terminal](https://www.microsoft.com/en-us/p/windows-terminal/9n0dx20hk701)
6. While the store is open search for Ubuntu and install
7. Goto [wslinstall](https://aka.ms/wslinstall) and follow instructions
8. Install [PowerToys](https://github.com/microsoft/PowerToys/releases)
9. Install [Git](https://git-scm.com/)

  - Information
  
    **Uncheck** "Only show new options"
  
  - Select Components

    You can uncheck all if you'd like

  - Choosing the default editor used by Git
  
    Select "Use Visual Studio Code as Git's default editor"

  - Adjust the name of the initial branch in new repositories

    Let Git decide

  - Adjusting your PATH environment

    Select "Use Git and optional Unix tools from the Windows Command Prompt"

    *You can adjust paths later (if you were worried)*
  
  - Choosing the SSH executable
  
    Select "Use bundled OpenSSL"

  - Choosing HTTPS transport backend

    Select "Use the OpenSSL Library"

  - Configure the line ending conversions

    Select "Checkout Windows-style, commit Unix-style line endings"

  - Configuring the terminal emulator to use with Git Bash
  
    Select "Use Windows' default console window"

    *On Windows 10 it's not as bad as the description makes it sound*

  - Choose the default behaviour of 'git pull'
  
    Select "Default (fast-forward or merge)"
  
  - Choose a credential helper
  
    Select "Git Credential Manager Core"

    *we'll be setting up ssh keys in WSL, but it could be helpful elsewhere*
    
   - Configuring extra options
   
     Defaults for file system caching and symbolic links are fine
   
   - Configuring experimental options
   
     Uncheck everything. Experiemental options are for containers

10. Launch an elevated command prompt

  (Press <kbd>Win</kbd>+<kbd>R</kbd>, type `cmd`, click OK, right click icon on taskbar, right click 'Command Prompt', right click 'Run as administrator')

  ```
  cd %USERPROFILE%
  md bin
  md development
  code bin\init.cmd bin\cmds.lst
  ```

  For Init.cmd put the following

  ```cmd
  @echo off
  set PATH=%PATH%;%~dp0
  if exist "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\Common7\Tools\VsDevCmd.bat" call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\Common7\Tools\VsDevCmd.bat" -arch=amd64 -host_arch=amd64
  alias -f "%USERPROFILE%\Bin\cmds.lst"
  pushd "%USERPROFILE%\development"
  ```

  _**NOTE:** If you want to adjust paths here, Press <kbd>Win</kbd>+<kbd>Pause</kbd> | Advanced system settings | Environment Variables..., adjust the PATH variables and update them in the above batch file. Previous instructions recommended removing ```C:\Users\<username>\AppData\Roaming\npm;``` from User variables for <username> and ```C:\Program Files\Git\cmd;C:\Program Files\Git\mingw64\bin;C:\Program Files\Git\usr\bin``` from System variables. This will break some Unity features and is no longer advised._

  Copy alias.exe into %USERPROFILE%\Bin if you haven't already.

  For cmds.lst put the following

  ```
  home pushd "%USERPROFILE%\Desktop"
  self pushd "%USERPROFILE%"
  bin  pushd "%USERPROFILE%\Bin"
  dev  pushd "%USERPROFILE%\Development"
  ```

11. Create a shortcut on your desktop with the following Target

  Right click on your desktop and select New | Shortcut

  For the location of the item put the following

  ```
  %ComSpec% /k "%USERPROFILE%\Bin\Init.cmd"
  ```

  Name it Dev Shell or whatever is easy to remember.

  Right click the icon and select Properties.
  Click the Advanced button and check 'Run as administrator'

12. Launch Windows Terminal click down caret and select Settings then click 'Open JSON file'

  ```js
  // This file was initially generated by Windows Terminal 1.0.1401.0
  // It should still be usable in newer versions, but newer versions might have additional
  // settings, help text, or changes that you will not see unless you clear this file
  // and let us generate a new one for you.

  // To view the default settings, hold "alt" while clicking on the "Settings" button.
  // For documentation on these settings, see: https://aka.ms/terminal-documentation
  {
      "$schema": "https://aka.ms/terminal-profiles-schema",

      "defaultProfile": "{2fb4199f-dbbf-47a3-ac82-bd1ee77a8287}",

      // You can add more global application settings here.
      // To learn more about global settings, visit https://aka.ms/terminal-global-settings

      // If enabled, selections are automatically copied to your clipboard.
      "copyOnSelect": false,

      // If enabled, formatted data is also copied to your clipboard
      "copyFormatting": false,

      // A profile specifies a command to execute paired with information about how it should look and feel.
      // Each one of them will appear in the 'New Tab' dropdown,
      //   and can be invoked from the commandline with `wt.exe -p xxx`
      // To learn more about profiles, visit https://aka.ms/terminal-profile-settings
      "profiles":
      {
          "defaults":
          {
              // Put settings here that you want to apply to all profiles.
          },
          "list":
          [
              {
                  // Make changes here to the powershell.exe profile.
                  "guid": "{61c54bbd-c2c6-5271-96e7-009a87ff44bf}",
                  "name": "Windows PowerShell",
                  "commandline": "powershell.exe",
                  "hidden": false
              },
              {
                  // Make changes here to the cmd.exe profile.
                  "guid": "{2fb4199f-dbbf-47a3-ac82-bd1ee77a8287}",
                  "name": "Dev Shell",
                  "commandline": "%ComSpec% /k \"%USERPROFILE%\\Bin\\Init.cmd\"",
                  "hidden": false
              },
              {
                  // Make changes here to the cmd.exe profile.
                  "guid": "{0caa0dad-35be-5f56-a8ff-afceeeaa6101}",
                  "name": "Command Prompt",
                  "commandline": "cmd.exe",
                  "hidden": false
              },
              {
                  "commandline": "\"C:/Program Files/Git/bin/bash.exe\" -i -l",
                  "fontFace": "Console",
                  "fontSize": 12,
                  "colorScheme": "One Half Dark",
                  "guid": "{4ae84548-75b3-4082-af6e-90a22a79cc0b}",
                  "icon": "ms-appdata:///roaming/git-for-windows.ico",
                  "name": "Git for Windows",
                  "startingDirectory": "~",
                  "closeOnExit": "always"
              },
              {
                  "guid": "{2c4de342-38b7-51cf-b940-2309a097f518}",
                  "hidden": false,
                  "name": "Ubuntu",
                  "source": "Windows.Terminal.Wsl",
                  "colorScheme": "UbuntuLegit"
              },
              {
                  "guid": "{b453ae62-4e3d-5e58-b989-0a998ec441b8}",
                  "hidden": false,
                  "name": "Azure Cloud Shell",
                  "source": "Windows.Terminal.Azure"
              }
          ]
      },

      // Add custom color schemes to this array.
      // To learn more about color schemes, visit https://aka.ms/terminal-color-schemes
      "schemes": [
          {
              "background":  "#2C001E",
              "black":  "#4E9A06",
              "blue":  "#3465A4",
              "brightBlack":  "#555753",
              "brightBlue":  "#729FCF",
              "brightCyan":  "#34E2E2",
              "brightGreen":  "#8AE234",
              "brightPurple":  "#AD7FA8",
              "brightRed":  "#EF2929",
              "brightWhite":  "#EEEEEE",
              "brightYellow":  "#FCE94F",
              "cyan":  "#06989A",
              "foreground":  "#EEEEEE",
              "green":  "#300A24",
              "name":  "UbuntuLegit",
              "purple":  "#75507B",
              "red":  "#CC0000",
              "white":  "#D3D7CF",
              "yellow":  "#C4A000"
          }        
      ],

      // Add custom keybindings to this array.
      // To unbind a key combination from your defaults.json, set the command to "unbound".
      // To learn more about keybindings, visit https://aka.ms/terminal-keybindings
      "keybindings":
      [
          // Copy and paste are bound to Ctrl+Shift+C and Ctrl+Shift+V in your defaults.json.
          // These two lines additionally bind them to Ctrl+C and Ctrl+V.
          // To learn more about selection, visit https://aka.ms/terminal-selection
          { "command": {"action": "copy", "singleLine": false }, "keys": "ctrl+c" },
          { "command": "paste", "keys": "ctrl+v" },

          // Press Ctrl+Shift+F to open the search box
          { "command": "find", "keys": "ctrl+shift+f" },

          // Press Alt+Shift+D to open a new pane.
          // - "split": "auto" makes this pane open in the direction that provides the most surface area.
          // - "splitMode": "duplicate" makes the new pane use the focused pane's profile.
          // To learn more about panes, visit https://aka.ms/terminal-panes
          { "command": { "action": "splitPane", "split": "auto", "splitMode": "duplicate" }, "keys": "alt+shift+d" }
      ]
  }
  ```

13. create ```~/.gitmessage``` and edit in code as follows

  ```

  # Title: Summary, imperative, start upper case, don't end with a period
  # No more than 50 chars. #### 50 chars is here: #

  # Remember blank line between title and body.

  # Body: Explain *what* and *why* (not *how*). Include task ID (Jira issue).
  # Wrap at 72 chars. ################################## which is here: #


  # At the end: Include Co-authored-by for all contributors. 
  # Include at least one empty line before it. Format: 
  # Co-authored-by: name <user@users.noreply.github.com>
  #
  # How to Write a Git Commit Message:
  # https://chris.beams.io/posts/git-commit/
  #
  # 1.Separate subject from body with a blank line
  # 2. Limit the subject line to 50 characters
  # 3. Capitalize the subject line
  # 4. Do not end the subject line with a period
  # 5. Use the imperative mood in the subject line
  # 6. Wrap the body at 72 characters
  # 7. Use the body to explain what and why vs. how

  ```

14. Launch the Windows Terminal and from Ubuntudev window from the shortcut

  configure git with the following commands

  ```bash
  $ git config --global user.name "Your Name Here"
  $ git config --global user.email "your_email@example.com"
  $ git config --global color.ui auto
  $ git config --global push.default simple
  $ git config --global core.filemode false
  $ git config --global fetch.prune true
  $ git config --global pull.rebase true
  # see http://adaptivepatchwork.com/2012/03/01/mind-the-end-of-your-line/
  $ git config --global core.autocrlf input
  $ git config --global core.safecrlf true

  # adds git lga command (try it, you'll love it)
  $ git config --global alias.lga "log --graph --oneline --all --decorate"
  $ git config --global alias.sync "pull --rebase --autostash"

  # If you want to unset any git config commands above
  # you can use the following command
  #$ git config --global --unset-all core.editor

  # configure VS code
  $ git config --global core.editor "code --wait"
  $ git config --global merge.tool vscode
  $ git config --global mergetool.vscode.cmd "code --wait $MERGED"
  $ git config --global diff.tool vscode
  $ git config --global difftool.vscode.cmd "code --wait --diff $LOCAL $REMOTE"

  # copy .gitmessage from machine-config to you home folder
  $ git config --global commit.template ~/.gitmessage

  # generate ssh keys
  $ ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
  Enter a file in which to save the key (/Users/you/.ssh/id_rsa): [Press enter]
  Enter passphrase (empty for no passphrase): [Press enter]
  Enter same passphrase again: [Press enter]
  $ eval "$(ssh-agent -s)"
  $ ssh-add ~/.ssh/id_rsa
  $ clip < ~/.ssh/id_rsa.pub
  ```

15. Goto [Github ssh settings](https://github.com/settings/ssh)
  - Click New SSH key
  - Enter a name for your machine
  - Right click in key field and select Paste
  - Click Add SSH key

16. Update hosts file

  Enter the following command in your dev window

  ```
  code C:\Windows\System32\drivers\etc\hosts
  ```
  add the following line to the end
  ```
  127.0.0.1 local.<yourdomainname>.com
  ```

17. Install essential [VS Code extensions](../docs/vscode/README.md)

18. Install [Beyond Compare](https://www.scootersoftware.com/download.php) and follow directions for [configuring](https://www.scootersoftware.com/support.php?zz=kb_vcs#gitwindows) From your Dev shell

